name: Release

on:
  push:
    branches:
      - main

permissions:
  contents: write
  pull-requests: write

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Set up Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Install semantic-release
        run: npm install -g semantic-release @semantic-release/changelog @semantic-release/git

      - name: Run semantic-release
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: semantic-release

      - name: Release summary
        if: always()
        run: |
          echo "‚úÖ Semantic release workflow completed"
          echo ""
          echo "Release process:"
          echo "1. Analyzed commit history using conventional commits"
          echo "2. Determined new version (major.minor.patch)"
          echo "3. Generated changelog"
          echo "4. Created git tag"
          echo "5. Created GitHub release"
          echo ""
          echo "üìç View releases: https://github.com/${{ github.repository }}/releases"
